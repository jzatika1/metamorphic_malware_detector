import logging
import sys
from pathlib import Path
from utils.config_manager import config

def setup_logging(debug: bool = False) -> None:
    """
    Set up logging for the application.

    Args:
        debug (bool): If True, set logging level to DEBUG. Otherwise, use the level from config.

    Returns:
        None
    """
    # Get logging configuration from config
    log_level = config.get('logging.level', 'INFO')
    log_file = config.get('logging.file', 'app.log')

    # Set the logging level
    if debug:
        level = logging.DEBUG
    else:
        level = getattr(logging, log_level.upper(), logging.INFO)

    # Create logs directory if it doesn't exist
    log_dir = Path(log_file).parent
    log_dir.mkdir(parents=True, exist_ok=True)

    # Configure logging
    logging.basicConfig(
        level=level,
        format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
        handlers=[
            logging.FileHandler(log_file),
            logging.StreamHandler(sys.stdout)
        ]
    )

    logging.info(f"Logging initialized. Level: {logging.getLevelName(level)}")